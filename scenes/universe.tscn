[gd_scene load_steps=22 format=3 uid="uid://qw0l40j2x8qo"]

[ext_resource type="Script" uid="uid://c2ejsyi7408jq" path="res://scripts/universe.gd" id="1_56nod"]
[ext_resource type="Shader" uid="uid://dxmi6ae305ccl" path="res://shaders/stars_skybox.gdshader" id="1_uc3kj"]
[ext_resource type="Script" uid="uid://bal5h2nf024hx" path="res://scripts/invader_template.gd" id="2_7viwd"]
[ext_resource type="Texture2D" uid="uid://cyjsc8pagl37o" path="res://assets/images/stars.png" id="2_jegdv"]
[ext_resource type="Script" uid="uid://cruraok6nexmg" path="res://scripts/skyCycle.gd" id="3_jegdv"]
[ext_resource type="PackedScene" uid="uid://bhec4di1vy6je" path="res://assets/models/Geodesic Dome.glb" id="3_qbb8e"]
[ext_resource type="PackedScene" uid="uid://dksuu6e7bmqf2" path="res://scenes/buncker.tscn" id="4_56nod"]
[ext_resource type="Script" uid="uid://b8cve7a3aicl5" path="res://scripts/sub_viewport.gd" id="6_5fwve"]
[ext_resource type="PackedScene" uid="uid://ddshenuk8qi2w" path="res://scenes/Mine.tscn" id="6_qbb8e"]
[ext_resource type="Shader" uid="uid://dufovwr4lc72q" path="res://shaders/crt_shader.gdshader" id="7_qbb8e"]
[ext_resource type="Script" uid="uid://c1aqjbyo3rgek" path="res://scripts/bunker_ui.gd" id="9_yb76g"]

[sub_resource type="Resource" id="Resource_3yicu"]
script = ExtResource("2_7viwd")
mesh_path = "res://assets/models/Spaceship.glb"
base_speed = 100.0
mesh_rescale = 3.0
metadata/_custom_type_script = "uid://bal5h2nf024hx"

[sub_resource type="Resource" id="Resource_yanup"]
script = ExtResource("2_7viwd")
mesh_path = "res://assets/models/Spaceship(1).glb"
base_speed = 75.0
spawn_delay = 10.0
mesh_rescale = 0.06
metadata/_custom_type_script = "uid://bal5h2nf024hx"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_cqgor"]
shader = ExtResource("1_uc3kj")
shader_parameter/northSkyColor = Vector4(0, 0, 0, 0)
shader_parameter/southSkyColor = Vector4(0, 0, 0, 0)
shader_parameter/skybox = ExtResource("2_jegdv")

[sub_resource type="Sky" id="Sky_p2ssq"]
sky_material = SubResource("ShaderMaterial_cqgor")

[sub_resource type="Environment" id="Environment_qnams"]
background_mode = 2
sky = SubResource("Sky_p2ssq")
glow_enabled = true
glow_normalized = true
glow_intensity = 2.0
glow_strength = 2.0
glow_bloom = 0.1

[sub_resource type="Gradient" id="Gradient_jegdv"]
offsets = PackedFloat32Array(0.32386363, 0.5, 0.92045456)
colors = PackedColorArray(0, 0.01102122, 0.17623302, 1, 0.8235294, 0.5372549, 0.3764706, 1, 1.0588765e-05, 0.7625525, 0.98469514, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_qbb8e"]
emission_enabled = true
emission = Color(1, 0.32156864, 0, 1)
emission_energy_multiplier = 3.0

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_cqgor"]
albedo_color = Color(1, 1, 0, 1)

[sub_resource type="SphereMesh" id="SphereMesh_siqxx"]
material = SubResource("StandardMaterial3D_cqgor")
radius = 100.0
height = 200.0

[sub_resource type="ShaderMaterial" id="ShaderMaterial_56nod"]
shader = ExtResource("7_qbb8e")
shader_parameter/overlay = true
shader_parameter/scanlines_opacity = 0.2000000095
shader_parameter/scanlines_width = 0.010000000475
shader_parameter/grille_opacity = 0.2000000095
shader_parameter/resolution = Vector2(640, 480)
shader_parameter/pixelate = true
shader_parameter/roll = true
shader_parameter/roll_speed = 4.0
shader_parameter/roll_size = 10.000000475
shader_parameter/roll_variation = 1.8
shader_parameter/distort_intensity = 0.010000000475
shader_parameter/noise_opacity = 0.05600000266
shader_parameter/noise_speed = 5.0
shader_parameter/static_noise_intensity = 0.00800000038
shader_parameter/aberration = 0.01000004797499998
shader_parameter/brightness = 1.4
shader_parameter/discolor = true
shader_parameter/warp_amount = 0.4270000202825
shader_parameter/clip_warp = false
shader_parameter/vignette_intensity = 0.4
shader_parameter/vignette_opacity = 0.5

[node name="universe" type="Node3D"]
script = ExtResource("1_56nod")
invaders_resources = Array[ExtResource("2_7viwd")]([SubResource("Resource_3yicu"), SubResource("Resource_yanup")])

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_qnams")
script = ExtResource("3_jegdv")
timeOfDay = 75.0
simulateTime = true
rateOfTime = 15.0
skyGradient = SubResource("Gradient_jegdv")

[node name="Sun" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.85436827, 0.51966834, 0, -0.51966834, 0.8543683, -585.77893, -92.15213, 655.1581)
layers = 3
material_override = SubResource("StandardMaterial3D_qbb8e")
cast_shadow = 0
mesh = SubResource("SphereMesh_siqxx")
skeleton = NodePath("DirectionalLight3D")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Sun"]
layers = 3
shadow_enabled = true
shadow_bias = 0.0
shadow_normal_bias = 0.0
sky_mode = 1

[node name="ships" type="Node3D" parent="."]

[node name="Earth" parent="." instance=ExtResource("3_qbb8e")]
transform = Transform3D(-19.984745, -0.78101146, 0, 0.78101146, -19.984745, 0, 0, 0, 20, 0, 0, 0)

[node name="HBoxContainer" type="HBoxContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = 4.0
grow_horizontal = 2
grow_vertical = 2

[node name="SubViewportContainer_p1" type="SubViewportContainer" parent="HBoxContainer"]
layout_mode = 2

[node name="SubViewport" type="SubViewport" parent="HBoxContainer/SubViewportContainer_p1"]
handle_input_locally = false
canvas_cull_mask = 4294967293
size = Vector2i(960, 1440)
size_2d_override = Vector2i(960, 0)
render_target_update_mode = 4
script = ExtResource("6_5fwve")
player_index = 1

[node name="mine" parent="HBoxContainer/SubViewportContainer_p1/SubViewport" instance=ExtResource("6_qbb8e")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.29501915, -59.98263)

[node name="buncker" parent="HBoxContainer/SubViewportContainer_p1" instance=ExtResource("4_56nod")]
process_mode = 4
transform = Transform3D(1, 0, 0, 0, -4.371139e-08, 1, 0, -1, -4.371139e-08, 0.08256529, -0.14809349, -85.37951)
visible = false
player_index = 1

[node name="SubViewportContainer_p2" type="SubViewportContainer" parent="HBoxContainer"]
layout_mode = 2

[node name="SubViewport" type="SubViewport" parent="HBoxContainer/SubViewportContainer_p2"]
handle_input_locally = false
canvas_cull_mask = 4294967294
size = Vector2i(960, 1440)
size_2d_override = Vector2i(960, 0)
render_target_update_mode = 4
script = ExtResource("6_5fwve")

[node name="buncker" parent="HBoxContainer/SubViewportContainer_p2/SubViewport" instance=ExtResource("4_56nod")]
transform = Transform3D(1, 0, 0, 0, -4.371139e-08, -1, 0, 1, -4.371139e-08, 0.08256529, -0.14809349, 85.49482)

[node name="mine" parent="HBoxContainer/SubViewportContainer_p2" instance=ExtResource("6_qbb8e")]
process_mode = 4
transform = Transform3D(-1, 0, 1.509958e-07, 0, 1, 0, -1.509958e-07, 0, -1, 0, -0.29501915, 59.624237)
visible = false

[node name="bunker_ui" type="Label" parent="."]
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -889.0
offset_top = -312.0
offset_right = -50.0
offset_bottom = -50.0
grow_horizontal = 0
grow_vertical = 0
theme_override_colors/font_color = Color(0, 1, 0, 1)
theme_override_colors/font_shadow_color = Color(0, 0, 0, 1)
theme_override_constants/shadow_offset_x = 5
theme_override_constants/shadow_offset_y = 5
theme_override_constants/shadow_outline_size = 5
theme_override_font_sizes/font_size = 36
vertical_alignment = 1
script = ExtResource("9_yb76g")
is_bunker_ui = true

[node name="mine_ui" type="Label" parent="."]
anchors_preset = 2
anchor_top = 1.0
anchor_bottom = 1.0
offset_left = 50.0
offset_top = -312.0
offset_right = 889.0
offset_bottom = -50.0
grow_vertical = 0
theme_override_colors/font_color = Color(0, 1, 0, 1)
theme_override_colors/font_shadow_color = Color(0, 0, 0, 1)
theme_override_constants/shadow_offset_x = 5
theme_override_constants/shadow_offset_y = 5
theme_override_constants/shadow_outline_size = 5
theme_override_font_sizes/font_size = 40
vertical_alignment = 1
script = ExtResource("9_yb76g")

[node name="end_game" type="Label" parent="."]
visible = false
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_colors/font_color = Color(1, 0, 0, 0.627451)
theme_override_colors/font_shadow_color = Color(0, 0, 0, 1)
theme_override_constants/shadow_offset_x = 5
theme_override_constants/shadow_offset_y = 5
theme_override_constants/shadow_outline_size = 5
theme_override_font_sizes/font_size = 125
text = "La Terre est perdue"
horizontal_alignment = 1
vertical_alignment = 1

[node name="CRTFilter" type="ColorRect" parent="."]
material = SubResource("ShaderMaterial_56nod")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
